- 基于证书生成RAS的公钥 KP 和私钥 KS
- 公钥加密身份

A 发送
{
 KP 加密的A身份数据
 KP 加密的B身份数据
 A的通信密钥
}

WALL 解析数据

- A将包括A的身份识别标志、B的身份识别标志及通信密钥KA的访问请求报文，经过公开密钥KP及RAS算法的加密，发送到关守系统上；

- 关守系统通过私钥KS及RAS算法解密所述访问请求报文，得到A的身份识别标志、B的身份识别标志和通信密钥KA ;

- 如果关守系统判断A有访问B的权限，则关守系统在B向关守系统发送自己当前IP地址的会话中，将A的访问请求用B向关守系统提供的通信密钥KB加密后，发送给B ;

- B收到关守系统发来的、来自A的访问请求后，生成通信密钥KC，并用所述通信密钥KB加密后，发送给关守系统；

- 关守系统用所述的通信密钥邸解密来自B的通信密钥KC,并将B的当前IP地址，通信密钥KC作为访问响应报文，用A的通信密钥KA加密，发送到A ；

- A利用密钥KA解密来自关守系统的访问响应报文，得到B的IP地址和与B通信用的密钥KC ；

- A利用B的IP地址，与B建立直接的会话，建立会话中涉及的报文内容，都可W用通信密钥KC进行加密。

- 上述关守系统上秘密保存着私钥KS,各个物联网终端上保存着从关守系统下载的 同一个公钥KP。